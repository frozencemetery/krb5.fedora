Tweaked from candidate for MITKRB5-SA-2010-005.
--- krb5/src/lib/gssapi/krb5/accept_sec_context.c	2010-05-04 10:51:06.000000000 -0400
+++ krb5/src/lib/gssapi/krb5/accept_sec_context.c	2010-05-04 10:56:48.000000000 -0400
@@ -384,6 +384,13 @@ krb5_gss_accept_sec_context(minor_status
    }
 #endif
 
+   if (authdat->checksum == NULL) {
+       /* missing checksum counts as "inappropriate type" */
+       code = KRB5KRB_AP_ERR_INAPP_CKSUM;
+       major_status = GSS_S_FAILURE;
+       goto fail;
+   }
+
    {
        /* gss krb5 v1 */
 
