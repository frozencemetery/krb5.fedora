From 1b6ea00bd6ac23020251bdeaf115a073c65c85d6 Mon Sep 17 00:00:00 2001
From: Robbie Harwood <rharwood@redhat.com>
Date: Wed, 1 Mar 2017 17:46:22 -0500
Subject: [PATCH] Use GSSAPI fallback skiptest

Also-authored-by: Matt Rogers <mrogers@redhat.com>
[rharwood@redhat.com: Adjusted patch to apply]
[rharwood@redhat.com: Adjusted patch again to apply]
---
 src/appl/gss-sample/Makefile.in | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/appl/gss-sample/Makefile.in b/src/appl/gss-sample/Makefile.in
index 0f67c0c05..e2434901c 100644
--- a/src/appl/gss-sample/Makefile.in
+++ b/src/appl/gss-sample/Makefile.in
@@ -8,6 +8,8 @@ OBJS= gss-client.o gss-misc.o gss-server.o
 
 all-unix:: gss-server gss-client
 
+LBITS = $(shell /usr/bin/getconf LONG_BIT)
+
 ##WIN32##VERSIONRC = $(BUILDTOP)\windows\version.rc
 ##WIN32##RCFLAGS=$(CPPFLAGS) -I$(top_srcdir) -D_WIN32 -DRES_ONLY
 
@@ -43,7 +45,9 @@ clean-unix::
 	$(RM) gss-server gss-client
 
 check-pytests::
-	$(RUNPYTEST) $(srcdir)/t_gss_sample.py $(PYTESTFLAGS)
+	if ! [ $(LBITS) -eq 32 ]; then \
+		$(RUNPYTEST) $(srcdir)/t_gss_sample.py $(PYTESTFLAGS); \
+	fi
 
 install-unix::
 	$(INSTALL_PROGRAM) gss-client $(DESTDIR)$(CLIENT_BINDIR)/gss-client
-- 
2.11.0

